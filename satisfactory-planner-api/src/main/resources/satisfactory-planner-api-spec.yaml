# This OpenAPI specification was generated on November 14, 2025.
# It was created by Gemini 2.5 Pro, a large language model trained by Google.
openapi: 3.0.3
info:
  title: Factory Planner API
  description: API for managing production plans for the game Satisfactory.
  version: 1.9.3
servers:
  - url: https://api.factoryplanner.example.com/v1
    description: Production Server

tags:
  - name: Game Data
    description: Endpoints for retrieving static game data (items, recipes, etc.).
  - name: Factory Management
    description: Endpoints for managing a user's saved factories (plans).
  - name: Analysis & Summary
    description: Endpoints for analyzing and summarizing existing factory plans.

paths:
  /items:
    get:
      tags: [Game Data]
      summary: Get all items (paginated)
      description: Retrieves a paginated list of all available items in the game.
      operationId: getAllItems
      x-spring-paginated: true
      parameters:
        - name: page
          in: query
          description: Page number (0-indexed).
          required: false
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Page size.
          required: false
          schema:
            type: integer
            default: 20
        - name: sort
          in: query
          description: "Sort criteria in the format: property,(asc|desc). Default sort is by name,asc."
          required: false
          schema:
            type: string
            default: "name,asc"
      responses:
        '200':
          description: A paginated list of items.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ItemPage'

  /items/{itemId}:
    get:
      tags: [Game Data]
      summary: Get a single item by ID
      description: Retrieves a specific item by its unique ID.
      operationId: getItemById
      parameters:
        - name: itemId
          in: path
          required: true
          description: The ID of the item to retrieve.
          schema:
            type: string
            format: uuid
            example: '123e4567-e89b-12d3-a456-426614174001'
      responses:
        '200':
          description: Item details found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Item'
        '404':
          $ref: '#/components/responses/NotFound'

  /recipes:
    get:
      tags: [Game Data]
      summary: Get all recipes (paginated)
      description: >
        Retrieves a paginated list of all available crafting recipes
        and resource extraction "pseudo-recipes".
      operationId: getAllRecipes
      x-spring-paginated: true
      parameters:
        - name: page
          in: query
          description: Page number (0-indexed).
          required: false
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Page size.
          required: false
          schema:
            type: integer
            default: 20
        - name: sort
          in: query
          description: "Sort criteria in the format: property,(asc|desc). Default sort is by name,asc."
          required: false
          schema:
            type: string
            default: "name,asc"
      responses:
        '200':
          description: A paginated list of recipes.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RecipePage'

  /recipes/{recipeId}:
    get:
      tags: [Game Data]
      summary: Get a single recipe by ID
      description: Retrieves a specific recipe by its unique ID.
      operationId: getRecipeById
      parameters:
        - name: recipeId
          in: path
          required: true
          description: The ID of the recipe to retrieve.
          schema:
            type: string
            format: uuid
            example: '123e4567-e89b-12d3-a456-426614174002'
      responses:
        '200':
          description: Recipe details found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Recipe'
        '404':
          $ref: '#/components/responses/NotFound'

  /buildings:
    get:
      tags: [Game Data]
      summary: Get all buildings (paginated)
      description: >
        Retrieves a paginated list of all available buildings
        (production, miners, generators, etc.).
      operationId: getAllBuildings
      x-spring-paginated: true
      parameters:
        - name: page
          in: query
          description: Page number (0-indexed).
          required: false
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Page size.
          required: false
          schema:
            type: integer
            default: 20
        - name: sort
          in: query
          description: "Sort criteria in the format: property,(asc|desc). Default sort is by name,asc."
          required: false
          schema:
            type: string
            default: "name,asc"
      responses:
        '200':
          description: A paginated list of buildings.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BuildingPage'

  /buildings/{buildingId}:
    get:
      tags: [Game Data]
      summary: Get a single building by ID
      description: Retrieves a specific building by its unique ID.
      operationId: getBuildingById
      parameters:
        - name: buildingId
          in: path
          required: true
          description: The ID of the building to retrieve.
          schema:
            type: string
            format: uuid
            example: '123e4567-e89b-12d3-a456-426614174003'
      responses:
        '200':
          description: Building details found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Building'
        '404':
          $ref: '#/components/responses/NotFound'

  /factories:
    get:
      tags: [Factory Management]
      summary: Get list of saved factories
      description: Retrieves a list of all factories (plans) saved by the user.
      operationId: getFactories
      responses:
        '200':
          description: A list of the user's factories.
          content:
            application/json:
              schema:
                type: array
                items: { $ref: '#/components/schemas/Factory' }
    post:
      tags: [Factory Management]
      summary: Create a new factory
      description: Creates a new, empty factory plan.
      operationId: createFactory
      requestBody:
        description: Data for the new factory.
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/FactoryInput' }
      responses:
        '201':
          description: Factory created successfully.
          content:
            application/json:
              schema: { $ref: '#/components/schemas/Factory' }
        '400':
          $ref: '#/components/responses/BadRequest'

  /factories/{factoryId}:
    parameters:
      - name: factoryId
        in: path
        required: true
        description: The ID of the factory to retrieve.
        schema: { type: string, format: uuid }
    get:
      tags: [Factory Management]
      summary: Get a single factory
      description: Retrieves the full details of a specific factory (plan) by its ID.
      operationId: getFactoryById
      responses:
        '200':
          description: Factory details.
          content:
            application/json:
              schema: { $ref: '#/components/schemas/Factory' }
        '404':
          $ref: '#/components/responses/NotFound'
    put:
      tags: [Factory Management]
      summary: Update a factory (save plan)
      description: >
        Updates the entire structure of a factory, including its name, description,
        and the full list of outposts and production nodes.
        This is the main "Save" endpoint.
      operationId: updateFactory
      requestBody:
        description: The new data for the factory.
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/FactoryInput' }
      responses:
        '200':
          description: Factory updated successfully.
          content:
            application/json:
              schema: { $ref: '#/components/schemas/Factory' }
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [Factory Management]
      summary: Delete a factory
      description: Permanently deletes a user's factory (plan).
      operationId: deleteFactory
      responses:
        '204':
          description: Factory deleted successfully (no content).
        '404':
          $ref: '#/components/responses/NotFound'

  /factories/{factoryId}/summary:
    parameters:
      - name: factoryId
        in: path
        required: true
        description: The ID of the factory to analyze.
        schema: { type: string, format: uuid }
    get:
      tags: [Analysis & Summary]
      summary: Get factory production summary
      description: >
        Analyzes the saved factory structure and returns a calculated
        net production/consumption summary for the entire factory
        and for each outpost individually.
      operationId: getFactorySummary
      responses:
        '200':
          description: The factory production summary.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FactorySummary'
        '404':
          $ref: '#/components/responses/NotFound'

components:
  schemas:
    ItemPage:
      type: object
      description: A paginated list of items.
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/Item'
        total_pages:
          type: integer
          description: Total number of pages.
          example: 10
        total_elements:
          type: integer
          format: int64
          description: Total number of elements across all pages.
          example: 95
        size:
          type: integer
          description: The number of elements requested in the page.
          example: 10
        number:
          type: integer
          description: The current page number (0-indexed).
          example: 0
        number_of_elements:
          type: integer
          description: The number of elements in the current page.
          example: 10
        last:
          type: boolean
          description: True if this is the last page.
        first:
          type: boolean
          description: True if this is the first page.
        empty:
          type: boolean
          description: True if the current page has no elements.
      required: [content, total_pages, total_elements, size, number, number_of_elements, last, first, empty]

    RecipePage:
      type: object
      description: A paginated list of recipes.
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/Recipe'
        total_pages:
          type: integer
          description: Total number of pages.
          example: 10
        total_elements:
          type: integer
          format: int64
          description: Total number of elements across all pages.
          example: 95
        size:
          type: integer
          description: The number of elements requested in the page.
          example: 10
        number:
          type: integer
          description: The current page number (0-indexed).
          example: 0
        number_of_elements:
          type: integer
          description: The number of elements in the current page.
          example: 10
        last:
          type: boolean
          description: True if this is the last page.
        first:
          type: boolean
          description: True if this is the first page.
        empty:
          type: boolean
          description: True if the current page has no elements.
      required: [content, total_pages, total_elements, size, number, number_of_elements, last, first, empty]

    BuildingPage:
      type: object
      description: A paginated list of buildings.
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/Building'
        total_pages:
          type: integer
          description: Total number of pages.
          example: 10
        total_elements:
          type: integer
          format: int64
          description: Total number of elements across all pages.
          example: 95
        size:
          type: integer
          description: The number of elements requested in the page.
          example: 10
        number:
          type: integer
          description: The current page number (0-indexed).
          example: 0
        number_of_elements:
          type: integer
          description: The number of elements in the current page.
          example: 10
        last:
          type: boolean
          description: True if this is the last page.
        first:
          type: boolean
          description: True if this is the first page.
        empty:
          type: boolean
          description: True if the current page has no elements.
      required: [content, total_pages, total_elements, size, number, number_of_elements, last, first, empty]

    NetItemRate:
      type: object
      description: >
        Represents the calculated net rate (production - consumption)
        for a single item, in items per minute.
      properties:
        item_id:
          type: string
          format: uuid
          description: The ID of the item (from /items).
          example: '123e4567-e89b-12d3-a456-426614174001'
        net_rate:
          type: number
          format: float
          description: >
            Calculated net rate (items/min).
            A positive number means overproduction (e.g., 10.0).
            A negative number means a deficit/input required (e.g., -5.0).
            Zero means production = consumption.
          example: 10.0
      required: [item_id, net_rate]

    ProductionSummary:
      type: object
      description: >
        Represents a summary object for a given scope
        (an entire factory or a single outpost).
      properties:
        net_item_rates:
          type: array
          description: >
            A list of all items with a non-zero net rate in this scope.
            Items with netRate = 0 are omitted.
          items:
            $ref: '#/components/schemas/NetItemRate'
        net_power_consumption:
          type: number
          format: float
          description: >
            Calculated net power consumption (MW).
            A positive number means consumption (deficit), e.g., 50.0.
            A negative number means power overproduction (surplus), e.g., -150.0.
          example: 50.0
        total_machine_count:
          type: number
          format: float
          description: The total (equivalent) number of machines in this scope.
          example: 12.5
      required: [net_item_rates, net_power_consumption, total_machine_count]

    FactorySummary:
      type: object
      description: A full analytical summary for an entire factory.
      properties:
        factory_id:
          type: string
          format: uuid
        factory_name:
          type: string
        total_summary:
          description: A summary for the entire factory.
          $ref: '#/components/schemas/ProductionSummary'
        outpost_summaries:
          description: A list of summaries for each outpost individually.
          type: array
          items:
            type: object
            properties:
              outpost_id:
                type: string
                format: uuid
              outpost_name:
                type: string
              summary:
                $ref: '#/components/schemas/ProductionSummary'
            required: [outpost_id, outpost_name, summary]
      required: [factory_id, factory_name, total_summary, outpost_summaries]

    Factory:
      type: object
      description: Represents a saved factory plan created by the user.
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for the factory (plan).
          readOnly: true
        name:
          type: string
          description: User-defined name for the factory.
          example: My HMF Factory
        description:
          type: string
          description: Optional description for the factory.
          example: A plan to produce 10 Heavy Modular Frames per minute.
          nullable: true
        outposts:
          type: array
          description: A list of outposts (production lines) within this factory.
          items:
            $ref: '#/components/schemas/Outpost'
          default: []
        created_at:
          type: string
          format: date-time
          description: The timestamp when the plan was created (server-set).
          readOnly: true
        updated_at:
          type: string
          format: date-time
          description: The timestamp of the last modification (server-set).
          readOnly: true
      required: [id, name, outposts, created_at, updated_at]

    Outpost:
      type: object
      description: Represents a single outpost or production line within a factory.
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for the outpost (server-set or client-provided for updates).
        name:
          type: string
          example: Iron Plate Production Line
        description:
          type: string
          nullable: true
        productions:
          type: array
          description: A list of production nodes within this outpost.
          items:
            $ref: '#/components/schemas/ProductionNode'
          default: []
      required: [id, name, productions]

    ProductionNode:
      type: object
      description: >
        A single production node (a group of machines).
        Defines which recipe is used, in which building, and how many.
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for the node (server-set or client-provided for updates).
        recipe_id:
          type: string
          format: uuid
          description: The ID of the recipe (from /recipes) being used.
          example: '123e4567-e89b-12d3-a456-426614174002'
        building_id:
          type: string
          format: uuid
          description: The ID of the building (from /buildings) running the recipe.
          example: '123e4567-e89b-12d3-a456-426614174003'
        machine_count:
          type: number
          format: float
          description: >
            Number of machines. Can be fractional (e.g., 0.5 for a machine
            at 50% clock speed, if clockSpeed = 1.0).
          example: 4.0
        clock_speed:
          type: number
          format: float
          description: The clock speed for this group of machines (1.0 = 100%, 2.5 = 250%).
          default: 1.0
      required: [id, recipe_id, building_id, machine_count]

    FactoryInput:
      type: object
      description: >
        Schema used for creating (POST) or updating (PUT) a factory.
        Does not include server-generated fields (like IDs or timestamps).
        When updating (PUT), the 'id' for 'outposts' and 'productions'
        must be preserved so the server can match existing records.
      properties:
        name:
          type: string
          example: My HMF Factory
        description:
          type: string
          example: A plan to produce 10 Heavy Modular Frames per minute.
          nullable: true
        outposts:
          type: array
          description: The full list of outposts and their production nodes.
          items:
            $ref: '#/components/schemas/Outpost'
          default: []
      required: [name]

    Item:
      type: object
      description: Represents a single in-game item (resource, part, equipment, etc.).
      properties:
        id:
          type: string
          format: uuid
          example: '123e4567-e89b-12d3-a456-426614174001'
        name:
          type: string
          example: Iron Plate
        description:
          type: string
          example: "Iron Plates are a basic component used in many recipes."
        stack_size:
          type: integer
          example: 100
        sink_value:
          type: integer
          example: 2
        energy_value:
          type: number
          format: float
          description: Energy value in Megajoules (MJ) when used as fuel. Null if not a fuel.
          example: 300
          nullable: true
        radioactive:
          type: boolean
          example: false
      required: [id, name, stack_size, sink_value]

    RecipeItemAmount:
      type: object
      description: >
        A helper schema linking an Item ID to a specific quantity
        used in a single craft cycle of a recipe.
      properties:
        item_id:
          type: string
          format: uuid
          description: The ID of the item being consumed or produced.
          example: '123e4567-e89b-12d3-a456-426614174001'
        amount:
          type: integer
          description: The number of items for one craft cycle.
          example: 3
      required: [item_id, amount]

    ItemRate:
      type: object
      description: >
        A helper schema linking an Item ID to a specific rate (per minute).
        Used primarily for generator fuel consumption.
      properties:
        item_id:
          type: string
          format: uuid
          description: The ID of the item being consumed.
          example: '123e4567-e89b-12d3-a456-426614174004'
        rate:
          type: number
          format: float
          description: The number of items consumed per minute.
          example: 15.0
      required: [item_id, rate]

    Recipe:
      type: object
      description: >
        Defines a single crafting recipe.
        Note: Resource extraction (Mining) is handled as a "pseudo-recipe"
        with no ingredients, a craftTime (e.g., 60s), and product (e.g., 120).
      properties:
        id:
          type: string
          format: uuid
          example: '123e4567-e89b-12d3-a456-426614174002'
        name:
          type: string
          example: Iron Plate
        craft_time:
          type: number
          format: float
          description: The time in seconds to complete one craft cycle at 100% clock speed.
          example: 4.0
        ingredients:
          type: array
          description: A list of items and amounts required to start one craft cycle (ingredients).
          items:
            $ref: '#/components/schemas/RecipeItemAmount'
        product:
          type: array
          description: A list of items and amounts produced in one craft cycle (product).
          items:
            $ref: '#/components/schemas/RecipeItemAmount'
        produced_in:
          type: array
          description: List of building IDs (UUIDs) that can craft this recipe.
          items:
            type: string
            format: uuid
          example: ["123e4567-e89b-12d3-a456-426614174003"]
        is_alternate:
          type: boolean
          description: True if this is an alternate recipe unlocked via Hard Drives.
          default: false
      required: [id, name, craft_time, ingredients, product, produced_in]

    Building:
      type: object
      description: Represents a single in-game building (machine, generator, etc.).
      properties:
        id:
          type: string
          format: uuid
          description: Unique machine-readable identifier.
          example: '123e4567-e89b-12d3-a456-426614174003'
        name:
          type: string
          description: Human-readable display name.
          example: Constructor
        description:
          type: string
          description: In-game description.
        category:
          type: string
          description: Helps organize buildings in the UI.
          example: "Production"
          enum: [Production, Mining, Power, Logistics, Other]
        power_consumption:
          type: number
          format: float
          description: >
            Base power consumption in Megawatts (MW) at 100% clock speed.
            Null for generators that only produce power.
          example: 4
          nullable: true
        power_consumption_exponent:
          type: number
          format: float
          description: >
            The exponent used for calculating power with clock speed changes.
            Formula: ActualPower = BasePower * (ClockSpeed ^ Exponent)
          example: 1.6
        power_production:
          type: number
          format: float
          description: >
            Power produced in Megawatts (MW).
            Null for buildings that only consume power.
          example: 75
          nullable: true
        can_set_clock_speed:
          type: boolean
          description: True if this is the building supports overclocking/underclocking.
          default: true
        can_set_recipe:
          type: boolean
          description: True if a recipe must be selected for this building to function.
          example: true
        fuel_inputs:
          type: array
          description: >
            A list of items and their consumption rates (per minute)
            required for this building to function (e.g., for generators).
          items:
            $ref: '#/components/schemas/ItemRate'
          nullable: true
      required: [id, name, category]

    ValidationError:
      type: object
      description: Describes a single validation error for a specific field.
      properties:
        field:
          type: string
          description: The name of the field that failed validation.
          example: name
        message:
          type: string
          description: The reason for the validation failure.
          example: Factory name cannot be empty.
      required: [field, message]

    ErrorResponse:
      type: object
      description: A standardized error response based on RFC 7807 Problem Details.
      properties:
        type:
          type: string
          format: uri
          description: A URI identifier for this type of problem.
          default: "about:blank"
          example: /errors/not-found
        title:
          type: string
          description: A short, human-readable summary of the problem type.
          example: Resource Not Found
        status:
          type: integer
          description: The HTTP status code.
          example: 404
        detail:
          type: string
          description: A human-readable explanation specific to this occurrence of the problem.
          example: Factory with ID 123e4567-e89b-12d3-a456-426614174000 not found.
        instance:
          type: string
          format: uri-reference
          description: A URI reference that identifies the specific occurrence of the problem.
          example: /v1/factories/123e4567-e89b-12d3-a456-426614174000
        validation_errors:
          type: array
          description: A list of specific field validation errors (extension member).
          items:
            $ref: '#/components/schemas/ValidationError'
          nullable: true
      required: [type, title, status, detail, instance]

  responses:
    NotFound:
      description: The requested resource was not found.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            type: "/errors/not-found"
            title: "Resource Not Found"
            status: 404
            detail: "Resource not found."
            instance: "/v1/items/123e4567-e89b-12d3-a456-426614174001"

    BadRequest:
      description: The request was malformed or failed validation.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          example:
            type: "/errors/validation-failed"
            title: "Bad Request"
            status: 400
            detail: "Validation failed."
            instance: "/v1/factories"
            validation_errors: [
              { "field": "name", "message": "Factory name cannot be empty." }
            ]